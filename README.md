# SpliceTransformer

SpliceTransformer(SpTransformer) is a deep learning tool to predict tissue specific splicing site from pre-mRNA sequence

## Requirement

### Environment

- Python 3.8 or higher
- numpy
- pandas
- pytorch>=1.10.2
- gffutils>=0.11.0
- tqdm
- sinkhorn-transformer

(bioconda channel of Conda is recommended for packages below)
- pyfaidx
- pyvcf3

### Genome annotation

The SpliceTransformer requires a genome assembly file and a genome annotation database file to locate genes and strands.

(1)A genome assembly file can be downloaded from ensemble.(e.g., https://ftp.ensembl.org/pub/release-110/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz). The uncompressed file should be placed at `./data/genome_annotation/` and renamed into `hg38.fa`

(2)Run the command below to create an annotation database file:

```bash
python annotator_pytorch.py Create_annotation_db ./data/genome_annotation/gencode.v38.annotation.gtf.gz
```

The default file is for hg38. Other version of annotation files can also be used.

## Run model

### Run

If the environment is properly set, the code below should run successfully.

```bash
python annotator_pytorch_2.py temporary
```

Then, the model prediction required by analysis pipelines can be generated by running:

```bash
python annotator_pytorch.py [task]
python annotator_pytorch_2.py [task]
```

The [task] should be replaced by task names recorded in the files `annotator_pytorch_2.py` or `annotator_pytorch.py`. The path of input files should be updated in the code.
The source data are not included in the repository. Details about how to get the input files are described in corresponding section of paper.

### Custom usage

The python class `Annotator` in `annotator_pytorch.py` showed examples for usage of SpTransformer. The code is able to be modified for custom usage.
